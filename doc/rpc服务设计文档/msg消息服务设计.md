

## 需求

* 实时性
* 可靠性
* 一致性



## 结构设计

| 字段 | 说明                                       |
| ---- | ------------------------------------------ |
| req  | 序列号                                     |
| ope  | 0单聊；1群聊                               |
| from | 发送者id                                   |
| to   | 接收者id                                   |
| type | 消息类型                                   |
| body | 消息正文，json格式，根据消息类型不同而不同 |
| ex   | 扩展字段                                   |



## 存储策略

由于需要支持数据漫游和历史消息，结合数据特点，使用mongodb全量存储







## 数据流模式















